name: CI

on:
  push:
    branches: [ main ]
  pull_request:

jobs:
  flutter:
    name: Flutter checks (always)
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: app
    steps:
      - uses: actions/checkout@v4

      # Flutter install
      - uses: subosito/flutter-action@v2
        with:
          channel: stable

      - name: Flutter version
        run: flutter --version

      - name: Pub get
        run: flutter pub get

      - name: Analyze
        run: flutter analyze

      - name: Test
        run: flutter test

      # NOTE: Coverage gating will be added once we generate stable coverage commands.

  e2e_appium:
    name: Appium E2E (optional)
    # This job is intentionally disabled on GitHub-hosted runners.
    # It should run on a self-hosted runner with Android SDK/emulator.
    if: false
    runs-on: self-hosted
    steps:
      - uses: actions/checkout@v4
      - name: Placeholder
        run: echo "Run Appium E2E on self-hosted runner"
